<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/heatmap.js"></script>
<script src="https://code.highcharts.com/modules/tilemap.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
<script type="text/javascript" src="util/messagingUtil.js"></script>
<script type="text/javascript" src="util/contentUtil.js"></script>
<head>
    <style>
        html {
            overflow: hidden;
        }

        html,
        body,
        #container {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            position: relative;
            border-style: none;
            border-width: 0px;
            overflow: auto;
        }
    </style>

</head>
<body>

<figure class="highcharts-figure">
    <div id="container"></div>
    <p class="highcharts-description">
        Hexagonal tilemap, sometimes referred to as a honeycomb or hexbin chart,
        showing population data in the US. In this case the map is used to show
        each US state with the same size - which removes some of the bias
        associated with traditional maps.
    </p>
</figure>

<script>

document.addEventListener('DOMContentLoaded', function () {
            va.messagingUtil.setOnDataReceivedCallback(onDataReceived);
        });

function onDataReceived(resultData) {
    if (!resultData) return;
    data_temp = resultData["data"]
  
    const va_data = []
     for (let i = 0; i < data_temp.length; i++){
    let temp_dict = {};
    temp_dict["'hc-a2'"]=data_temp[i][1]
    temp_dict["name"]=data_temp[i][2]
    temp_dict["region"]=data_temp[i][3]
    temp_dict["x"]=data_temp[i][4]
    temp_dict["y"]=data_temp[i][5]
    temp_dict["value"]=data_temp[i][6]

    console.log(temp_dict);
        va_data.push(temp_dict);
     }

 highchartmaker(va_data);
}

//sample data
// va_data = [{'hc-a2': 'AL',name: 'Alabama',region: 'South',x: 6,y: 7,value: 5108468}]

function highchartmaker(input_data) {

Highcharts.chart('container', {
    chart: {
        type: 'tilemap',
        inverted: true,
        height: '80%'
    },
    xAxis: {
        visible: false
    },

    yAxis: {
        visible: false
    },

    colorAxis: {
        dataClasses: [{
            from: 0,
            to: 1000000,
            color: '#F9EDB3',
            name: '< 1M'
        }, {
            from: 1000000,
            to: 5000000,
            color: '#FFC428',
            name: '1M - 5M'
        }, {
            from: 5000000,
            to: 20000000,
            color: '#FF7987',
            name: '5M - 20M'
        }, {
            from: 20000000,
            color: '#FF2371',
            name: '> 20M'
        }]
    },

    tooltip: {
        headerFormat: '',
        pointFormat: 'The population of <b> {point.name}</b> is <b>' +
            '{point.value}</b>'
    },

    plotOptions: {
        series: {
            dataLabels: {
                enabled: true,
                format: '{point.hc-a2}',
                color: '#000000',
                style: {
                    textOutline: false
                }
            }
        }
    },

    series: [{
        data: input_data
    }]
})
};

</script>
</body>